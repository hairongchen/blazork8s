@page "/NodeList"
@using Extensions
@using Extensions.k8s
@using k8s.Models
@if (_nodes == null)
{
    <p>
        <em>Loading...</em>
    </p>
}
else
{
    foreach (var node in _nodes.Items)
    {
        bool isReady = node.Status.Conditions.IsReady();
        var color = isReady ? Color.Success : Color.Danger;
        <Card style="width: 18rem;" Color="color">
            <CardHeader>
                <div>
                    <p class="card-text"> @node.Metadata.Name</p>
                    @foreach (var role in node.Metadata.NodeRoles())
                    {
                        <Tag ShowBar="true">@role</Tag>
                    }
                    Pods:@_pods.PodListInNode(node.Name()).readySummary()
                </div>
            </CardHeader>
            <CardBody>

                <GroupBox Title="Pod状态 ">
                    <p>

                        @foreach (var pod in _pods.PodListInNode(node.Name()))
                        {
                            var color = Color.Warning;
                            if (pod.Status() == "Running")
                            {
                                color = Color.Success;
                            }
                            if (pod.Status() == "Succeeded")
                            {
                                color = Color.Dark;
                            }
                            if (pod.Status() == "Terminating")
                            {
                                color = Color.Danger;
                            }
                            if (pod.Status() == "Failed")
                            {
                                color = Color.Danger;
                            }
                            var icon = pod.isReady() ? "fa fa-fw fa-check-circle" : "fa fa-fw fa-warning";
                            <Tag Color="@color" Icon="@icon" style="box-sizing: border-box">
                                @* @pod.Name() @pod.readySummary() *@
                                &nbsp;
                            </Tag>
                        }

                    </p>
                </GroupBox>
            </CardBody>
            <CardFooter>
            @if (isReady)
                {
                    <Tag Icon="fa fa-check-circle" Color="Color.Success">Ready</Tag>
                }
<Tag Icon="fa fa-clock-o" >@node.Metadata.CreationTimestamp?.AgeFromUtc()</Tag>


                <Tag Color="Color.Primary">@node.Status.NodeInfo.Architecture</Tag>
                @node.Status.NodeInfo.KubeletVersion

            </CardFooter>
        </Card>
    }
}
