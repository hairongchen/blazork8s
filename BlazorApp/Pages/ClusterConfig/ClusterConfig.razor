@page "/ClusterConfig"
@using k8s.Models
@using Mapster
@using BlazorApp.Pages.Common.Html.HTable
@using BlazorApp.Pages.Common.Html
@using BlazorApp.Pages.Common


<Card Title="@KubeService.CurrentContext()" Style="width: 400px;margin: 50px">
    @if (ComponentStatus is { Count: > 0 })
    {
        <HTable>
            @foreach (var status in ComponentStatus)
            {
                <HTableColumn Title="@status.Name()">
                    <ConditionsTagView Conditions="@(status.Conditions.Adapt<IList<V1Condition>>())"></ConditionsTagView>
                </HTableColumn>
            }
        </HTable>
    }
</Card>
@if (ApiServicesList is { Count: > 0 })
{
    <Card Title="API Services" Style="margin: 20px">
        <HTable Class="wideTableWithGrid">
            <HTr>
                <HTd>
                    Name
                </HTd>
                <HTd>
                    Status
                </HTd>
            </HTr>
            @foreach (var item in ApiServicesList)
            {
                <HTr>
                    <HTd>
                        @item.Name()
                    </HTd>
                    <HTd>
                        <ConditionsTagView Conditions="@(item.Status.Conditions.Adapt<IList<V1Condition>>())"></ConditionsTagView>
                    </HTd>
                </HTr>
            }
        </HTable>
    </Card>
}

@if (PodList is { Count: > 0 })
{
        <HTable Class="wideTableWithGrid">
            @foreach (var pod in PodList)
            {
                <HTr>
                    <HTd>
                        @pod.Name()
                    </HTd>
                    <HTd>
                        @pod.CreationTimestamp()
                    </HTd>
                    <HTd>
                        <MetricView ResourceType="Pod" ItemName="@pod.Name()" MetricType="cpu"></MetricView>
                    </HTd>
                    <HTd>
                        <MetricView ResourceType="Pod" ItemName="@pod.Name()" MetricType="memory"></MetricView>
                    </HTd>
                </HTr>
            }
        </HTable>
}


@if (NodeList is { Count: > 0 })
{
    <HTable Class="wideTableWithGrid">
        @foreach (var node in NodeList)
        {
            <HTr>
                <HTd>
                    @node.Name()
                </HTd>
                <HTd>
                    @node.CreationTimestamp()
                </HTd>
                <HTd>
                    <MetricView ResourceType="Node" ItemName="@node.Name()" MetricType="cpu"></MetricView>
                </HTd>
                <HTd>
                    <MetricView ResourceType="Node" ItemName="@node.Name()" MetricType="memory"></MetricView>
                </HTd>
            </HTr>
        }
    </HTable>
}
