@using k8s.Models
@using BlazorApp.Pages.Common.Html
@using BlazorApp.Pages.Common.Html.HTable
@using BlazorApp.Pages.Common.Metadata
@using BlazorApp.Pages.Common
@if (Ingress is { Count: > 0 })
{
    <HTableColumn Title="@Title">
        <HTable Class="miniTable">
            @foreach (var ingressRule in Ingress)
            {
                @if (ingressRule.FromProperty is { Count: > 0 })
                {
                    <HTableColumn Title="From">
                        <HTable>
                            <NetworkPolicyPeerView Peers="ingressRule.FromProperty" ExplainField="networkPolicy.spec.ingress.from"></NetworkPolicyPeerView>
                        </HTable>
                    </HTableColumn>
                }

                @if (ingressRule.Ports is { Count: > 0 })
                {
                    <HTableColumn Title="Ports">
                        @foreach (var port in ingressRule.Ports)
                        {
                            <HTable Class="miniTable">
                                <PropertyOptionView Title="Protocol" Item="port.Protocol" ExplainField="networkPolicy.spec.ingress.ports" Options='@(new[] { "TCP", "UDP", "SCTP" })'></PropertyOptionView>
                                <HTableColumn Title="Ports">
                                    <ColorfulTag>
                                        @port.Port
                                        @if (port.EndPort != null)
                                        {
                                            @($" - {port.EndPort}")
                                        }
                                    </ColorfulTag>
                                    <KubectlExplainButton Field="networkPolicy.spec.ingress.ports"></KubectlExplainButton>
                                </HTableColumn>
                            </HTable>
                        }
                    </HTableColumn>
                }
            }
        </HTable>
        <KubectlExplainButton Field="networkPolicy.spec.ingress"></KubectlExplainButton>
    </HTableColumn>
}

@code {

    [Parameter]
    public IList<V1NetworkPolicyIngressRule> Ingress { get; set; }

    [Parameter]
    public string Title { get; set; }

}
