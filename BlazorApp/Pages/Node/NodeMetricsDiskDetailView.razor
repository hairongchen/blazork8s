@using BlazorApp.Pages.Cluster
@using BlazorApp.Service.k8s
@using BlazorApp.Utils.Prometheus.Models.Interfaces
@using k8s.Models
@inherits BlazorApp.Pages.Common.DrawerPageBase<V1Node>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["machine_nvm_capacity"]
                            MetricName="machine_nvm_capacity" Unit="bytes">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["machine_nvm_avg_power_budget_watts"]
                            MetricName="machine_nvm_avg_power_budget_watts">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_blkio_device_usage_total"]
                            MetricName="container_blkio_device_usage_total"
                            Unit="bytes">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_file_descriptors"]
                            MetricName="container_file_descriptors">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_inodes_free"]
                            MetricName="container_fs_inodes_free">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_inodes_total"]
                            MetricName="container_fs_inodes_total">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_io_current"]
                            MetricName="container_fs_io_current">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_io_time_seconds_total"]
                            MetricName="container_fs_io_time_seconds_total"
                            Unit="seconds">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics"
                            Title=@L["container_fs_io_time_weighted_seconds_total"]
                            MetricName="container_fs_io_time_weighted_seconds_total"
                            Unit="seconds">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_limit_bytes"]
                            MetricName="container_fs_limit_bytes" Unit="bytes">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_read_seconds_total"]
                            MetricName="container_fs_read_seconds_total"
                            Unit="seconds">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_reads_bytes_total"]
                            MetricName="container_fs_reads_bytes_total"
                            Unit="bytes">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_reads_merged_total"]
                            MetricName="container_fs_reads_merged_total">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_reads_total"]
                            MetricName="container_fs_reads_total">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_sector_reads_total"]
                            MetricName="container_fs_sector_reads_total">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_sector_writes_total"]
                            MetricName="container_fs_sector_writes_total">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_usage_bytes"]
                            MetricName="container_fs_usage_bytes" Unit="bytes">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_write_seconds_total"]
                            MetricName="container_fs_write_seconds_total"
                            Unit="seconds">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_writes_bytes_total"]
                            MetricName="container_fs_writes_bytes_total"
                            Unit="bytes">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_writes_merged_total"]
                            MetricName="container_fs_writes_merged_total">
</MetricsCounterGaugeSumView>
<MetricsCounterGaugeSumView AllMetrics="@CAdvisorMetrics" Title=@L["container_fs_writes_total"]
                            MetricName="container_fs_writes_total"
                            Unit="bytes">
</MetricsCounterGaugeSumView>
<MetircsHistogramTotalAvgView AllMetrics="@Metrics"
                              Title=@L["storage_operation_duration_seconds"]
                              MetricName="storage_operation_duration_seconds" Unit="seconds"
                              MultipleGroupBy="@(new List<string> { "volume_plugin", "operation_name" })">
</MetircsHistogramTotalAvgView>

@code {
    [Parameter] public V1Node Node { get; set; }

    [Inject] INodeService NodeService { get; set; }
    private IList<IMetric> Metrics { get; set; }
    private IList<IMetric> CAdvisorMetrics { get; set; }
    private IList<IMetric> ResourceMetrics { get; set; }

    protected override async Task OnInitializedAsync()
    {
        Node = Options;
        Metrics = await NodeService.GetMetrics(Node.Name());
        CAdvisorMetrics = await NodeService.GetCadvisorMetrics(Node.Name());
        ResourceMetrics = await NodeService.GetResourceMetrics(Node.Name());

        await base.OnInitializedAsync();
    }


}
