@using k8s.Models
@using BlazorApp.Service.k8s
@using BlazorApp.Pages.Common
@if (_isMetricsServerReady)
{
    <Divider Orientation="left" Style="font-weight:bold">Container Metrics</Divider>
    <GridRow Class="grid-table">
        <GridCol Span="8">Container Name</GridCol>
        <GridCol Span="8">CPU</GridCol>
        <GridCol Span="8">Memory</GridCol>
    </GridRow>
    @foreach (var item in Containers)
    {
        <GridRow Class="grid-table grid-table-first-row">
            <GridCol Span="8">@item.Name</GridCol>
            <GridCol Span="8">
                <MetricView ResourceType="Container" ItemName="@PodName" ContainerName="@item.Name" MetricType="cpu"></MetricView>
            </GridCol>
            <GridCol Span="8">
                <MetricView ResourceType="Container" ItemName="@PodName" ContainerName="@item.Name" MetricType="memory"></MetricView>
            </GridCol>
        </GridRow>
    }
}

@code {


    [Parameter]
    public string PodName { get; set; }

    [Parameter]
    public IList<V1Container> Containers { get; set; }

    [Inject]
    private IMetricsService MetricsService { get; set; }

    private bool _isMetricsServerReady;

    protected override async Task OnInitializedAsync()
    {
        _isMetricsServerReady = await MetricsService.MetricsServerReady();
        await base.OnInitializedAsync();
    }

}
